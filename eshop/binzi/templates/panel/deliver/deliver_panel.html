{% extends 'panel/base/base_deliver.html' %}
{% load static %}

{% block title %}Deliver Panel Dashboard{% endblock %}

{% block content %}
<div class="container">
    <h1 class="mt-4 animate__animated animate__fadeIn">Welcome to the National ID Admin Panel - Deliver Panel</h1>
    <p class="animate__animated animate__fadeIn animate__delay-1s">Manage all aspects of National ID card delivery, from order management to delivery tracking.</p>

    <!-- Additional Sections -->
    <section class="additional-features mt-5 animate__animated animate__fadeIn animate__delay-2s">
        <h2>Additional Features</h2>
        <div class="row">
            <div class="col-md-6">
                <h5><i class="fas fa-map-marker-alt"></i> Geolocation Tracking</h5>
                <p>Real-time tracking of delivery personnel location to ensure timely and accurate deliveries.</p>
            </div>
            <div class="col-md-6">
                <h5><i class="fas fa-signature"></i> Proof of Delivery</h5>
                <p>Capture electronic or digital signatures upon delivery to confirm successful handover.</p>
            </div>
            <div class="col-md-6 mt-3">
                <h5><i class="fas fa-comments"></i> Customer Feedback</h5>
                <p>Integrate customer feedback systems to gather insights and improve delivery services.</p>
            </div>
            <div class="col-md-6 mt-3">
                <h5><i class="fas fa-map"></i> Integration with Mapping Services</h5>
                <p>Enhance your delivery process with integrations such as Google Maps for navigation and traffic updates.</p>
            </div>
        </div>
    </section>

    <!-- Geolocation Section -->
    <section class="geolocation mt-5 animate__animated animate__fadeIn animate__delay-3s">
        <h2>Geolocation</h2>
        <button class="btn btn-primary" id="get-location">Get My Location</button>
        <p id="location-output" class="mt-3"></p>
        <div id="map" style="height: 400px; width: 100%;"></div>
    </section>

    <!-- Footer -->
    <footer class="mt-5 text-center">
        <p>&copy; 2024 National ID Admin Panel. All rights reserved.</p>
    </footer>
</div>
{% endblock %}

{% block extra_js %}
<script>
    let map;

    function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
            center: {lat: -34.397, lng: 150.644},
            zoom: 8
        });
    }

    document.getElementById('get-location').addEventListener('click', function() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition, showError);
        } else {
            document.getElementById('location-output').innerText = "Geolocation is not supported by this browser.";
        }
    });

    function showPosition(position) {
        const lat = position.coords.latitude;
        const lon = position.coords.longitude;
        document.getElementById('location-output').innerText = "Latitude: " + lat + ", Longitude: " + lon;

        const latLng = new google.maps.LatLng(lat, lon);
        map.setCenter(latLng);
        map.setZoom(15);

        new google.maps.Marker({
            position: latLng,
            map: map,
            title: 'You are here'
        });
    }

    function showError(error) {
        switch(error.code) {
            case error.PERMISSION_DENIED:
                document.getElementById('location-output').innerText = "User denied the request for Geolocation.";
                break;
            case error.POSITION_UNAVAILABLE:
                document.getElementById('location-output').innerText = "Location information is unavailable.";
                break;
            case error.TIMEOUT:
                document.getElementById('location-output').innerText = "The request to get user location timed out.";
                break;
            case error.UNKNOWN_ERROR:
                document.getElementById('location-output').innerText = "An unknown error occurred.";
                break;
        }
    }
</script>
{% endblock %}